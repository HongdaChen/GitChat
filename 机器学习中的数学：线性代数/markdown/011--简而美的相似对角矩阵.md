### 构造对角化转换矩阵 P 的思路

现在，我们来讨论上一讲末尾遗留的那个问题：既然我们知道对角矩阵是具有最佳性质的相似矩阵，并且我们可以通过 $P^{-1}AP$ 得到矩阵 A
的相似对角矩阵，那么转换矩阵 P 给如何构造？

很简单，我们直接从这个式子入手。

首先，矩阵 P 和 A 一样，均为 n 阶方阵。为了方便分析和描述，我们把它写成一组列向量并排排列的形式：

$$P=\begin{bmatrix} p_{1}&p_{2}&...&p_{n} \end{bmatrix}$$

即 n 个 n 维列向量的横向排列。有了这个表达的基础，我们下面开始推导：

针对 $P^{-1}AP=\Lambda$ 的表达式，两边同时左乘矩阵 P，则有 $AP=P\Lambda$，我们进一步利用完整形式展开：

$$A\begin{bmatrix} p_{1},p_{2},...,p_{n} \end{bmatrix}=$$ $$\begin{bmatrix}
p_{1},p_{2},...,p_{n} \end{bmatrix} \begin{bmatrix} \lambda_{1} & && \\\
&\lambda_{2} & &\\\&&...&\\\ & &&\lambda_{n}\end{bmatrix}$$

最终有：

$$\begin{bmatrix} Ap_{1},Ap_{2},...,Ap_{n} \end{bmatrix}=\begin{bmatrix}
\lambda_{1}p_{1},\lambda_{2}p_{2},...,\lambda_{n}p_{n} \end{bmatrix}$$

看到这里，就豁然开朗了，为了上面这个等式能成立，就必须让左右两边的向量在每个维度上分别相等。即

$$Ap_{1}=\lambda_{1}p_{1}，Ap_{2}=\lambda_{2}p_{2}，...，$$
$$Ap_{n}=\lambda_{n}p_{n}$$

此时问题就进一步具体化了。

第一步是：我们要找到满足上述等式的这一组向量 $p_{1},p_{2},...,p_{n}$。找到它们之后，我们将其横向排列，就构成了我们苦心寻找的转换矩阵

$$P=\begin{bmatrix} p_{1}&p_{2}&...&p_{n} \end{bmatrix}$$

第二步是：将分别与向量 $p_1,p_2,...,p_n$ 对应的值 $\lambda_{1},\lambda_{2},...\lambda_{n}$
依序沿着对角线排列，就构成了与矩阵 A 相似的对角矩阵

$$\Lambda=\begin{bmatrix} \lambda_{1} & && \\\ &\lambda_{2} && \\\&&.&\\\&&
&\lambda_{n}\end{bmatrix}$$

### 引入特征向量和特征值

#### “特征”二字到底指什么

满足上文中介绍的等式：$Ap=\lambda p$ 的非零列向量 $p_{i}$ 和对应的值 $\lambda_{i}$ 分别称之为方阵的 **特征向量**
和 **特征值** 。为什么称之为“特征”？是因为这一类向量和值属于该方阵 A 的固有属性。

一般而言，对于一个向量 x，在矩阵 A 的作用下发生线性变换 Ax=b，变换后，向量 x 的方向和长度都会发生变化，如果 A
不是方阵，连向量的维度都会发生改变。而我们从 $Ap=\lambda p$ 这个式子中却能够发现这个重要的现象：

> 在方阵 A 的变换作用下，特征向量 p 的线性变换就是在其向量方向上进行 $\lambda$
> 倍的伸缩变换。说得更直白一些，就是仅仅只有向量的长度发生改变，但是方向并不改变。具备了这种特殊性，就称之为特征。

我们接着再观察一下对角化的等式：$P^{-1}AP=\Lambda$，看看能否发现其他更多的特性。

  * 首先：从等式直接看出，由特征向量构成的矩阵 P 要求是可逆的，也就是说方阵 A 的特征向量必须满足线性无关，矩阵 A 才能进行对角化。
  * 其次：我们把等式右侧移到左侧，有：$(A-\lambda I)p=0$，用前面知识描述就是，向量 p 是矩阵 $A-\lambda I$ 的零空间，由于向量 p 有非零的前提条件，因此 $A-\lambda I$ 是一个不可逆矩阵。

#### 几何意义

对于一个特定向量 v，如果我们使用默认基底 $(e_{1},e_{2},...,e_{n})$
对其进行表示，向量即被表示为：$x_{1}e_{1}+x_{2}e_{2}+...+x_{n}e_{n}$。使用方阵 A
对其进行线性变换，那么正如我们前面内容所介绍的，这一组默认的基底就会变成一组新的目标向量，一般情况下，原始的基向量和转换后的目标向量是不共线的。

此时，我们对该向量更换一组基底进行表示，采用方阵 A 的一组特征向量 $(p_{1},p_{2},...,p_{n})$ 作为其新的基底，则该向量表示为
$y_{1}p_{1}+y_{2}p_{2}+...+y_{n}p_{n}$，其新的坐标为 $\begin{bmatrix}
y_{1}&y_{2}&...&y_{n} \end{bmatrix} ^{T}$，在此基础上利用方阵 A 对其进行线性变换：

$$Av=A(y_{1}p_{1}+y_{2}p_{2}+...+y_{n}p_{n})$$

$$A(y_{1}p_{1}+y_{2}p_{2}+...+y_{n}p_{n})$$
$$=Ay_{1}p_{1}+Ay_{2}p_{2}+...+Ay_{n}p_{n}$$

再用上我们前面讲过的 $Ap=\lambda p$，替换一下就有：

$$Ay_{1}p_{1}+Ay_{2}p_{2}+...+Ay_{n}p_{n}$$
$$=\lambda_{1}y_{1}p_{1}+\lambda_{2}y_{2}p_{2}+...+\lambda_{n}y_{n}p_{n}$$

这个结果是非常漂亮的，利用基底 $(p_{1},p_{2},...,p_{n})$ 表示的向量 v，经过矩阵 A
的线性转换，其基底在保持不变的前提下，向量坐标由 $\begin{bmatrix} y_{1},y_{2},...,y_{n} \end{bmatrix}
^{T}$ 变为 $\begin{bmatrix}
\lambda_{1}y_{1},\lambda_{2}y_{2},...,\lambda_{n}y_{n} \end{bmatrix} ^{T}$。

我们最后再来概况一下其几何含义：

> 对一个向量进行矩阵 A 描述的线性变换，如果用矩阵 A 的特征向量 $(p_{1},p_{2},...,p_{n})$
> 作为基底对该向量进行坐标表示，该空间变换即可简化为各个维度的坐标值在其基向量方向上对应伸缩 $\lambda_{i}$ 倍。

### 用基变换的方法再次推导对角化过程

利用基底变换的方法，我们再来分析一下对角化的具体过程，我们来看一个三维空间的例子。

矩阵 A 的三个特征向量依次为：

$$p_{1}=\begin{bmatrix} p_{11} \\\ p_{21} \\\p_{31}
\end{bmatrix}，p_{2}=\begin{bmatrix} p_{12} \\\ p_{22} \\\p_{32}
\end{bmatrix}，p_{3}=\begin{bmatrix} p_{13} \\\ p_{23} \\\p_{33}
\end{bmatrix}$$

用默认基底 $(e_{1},e_{2},e_{3})$ 和由特征向量 $(p_{1},p_{2},p_{3})$
构成的基底分别对同一向量进行表示，有：$x_{1}e_{1}+x_{2}e_{2}+x_{3}e_{3}$$=y_{1}p_{1}+y_{2}p_{2}+y_{3}p_{3}$，我们利用基向量将这个等式展开：

$$x_{1}\begin{bmatrix}1 \\\ 0\\\0 \end{bmatrix} +x_{2}\begin{bmatrix}0 \\\
1\\\0 \end{bmatrix} +x_{3}\begin{bmatrix}0 \\\ 0\\\1 \end{bmatrix}=$$
$$y_{1}\begin{bmatrix} p_{11} \\\ p_{21} \\\p_{31} \end{bmatrix}
+y_{2}\begin{bmatrix} p_{12} \\\ p_{22} \\\p_{32} \end{bmatrix}
+y_{3}\begin{bmatrix} p_{13} \\\ p_{23} \\\p_{33} \end{bmatrix}$$

再对式子进行展开：

$$x_{1}=p_{11}y_{1}+p_{12}y_{2}+p_{13}y_{3}$$
$$x_{2}=p_{21}y_{1}+p_{22}y_{2}+p_{23}y_{3}$$
$$x_{3}=p_{31}y_{1}+p_{32}y_{2}+p_{33}y_{3}$$

很明显，可以用矩阵乘法进行表示：

$$\begin{bmatrix} x_{1} \\\ x_{2} \\\x_{3} \end{bmatrix} =\begin{bmatrix}
p_{11}&p_{12}&p_{13} \\\ p_{21}&p_{22}&p_{23} \\\p_{31}&p_{32}&p_{33}
\end{bmatrix} \begin{bmatrix} y_{1} \\\ y_{2} \\\y_{3} \end{bmatrix}$$
$$\Rightarrow x=Py$$

取逆，则有 $y=P^{-1}x$。

有了 $y=P^{-1}x$ 这个转换等式，我们继续往下分析。

因此，对于向量在空间中的位置改变，在基底 $(e_{1},e_{2},...,e_{n})$ 进行的坐标表示下，我们的变换矩阵为 A，而在基底
$(p_{1},p_{2},...,p_{n})$ 下，变换矩阵为 $\Lambda$。

那么，首先从基底 $(e_{1},e_{2},...,e_{n})$ 变换到基底 $(p_{1},p_{2},...,p_{n})$ 下，向量的坐标值由 x
变为 $P^{-1}x$，接着就能利用左乘矩阵 $\Lambda$ 进行线性变换，即 $\Lambda P^{-1}x$，线性变换结束后，我们要重新回到基底
$(e_{1},e_{2},...,e_{n})$ 下的坐标表示，所以再做一次逆变换，即 $P\Lambda P^{-1}x$，整个过程和 Ax
殊途同归，因此才有了 $A=P\Lambda P^{-1}$。

说到这里，对角化里涉及的正反等式：

$$A=P\Lambda P^{-1}，\Lambda=P^{-1}AP$$

本质意义就十分清晰了。

那么对于一个方阵 A，如何具体的求取它的特征向量和特征值，从而求得对角矩阵，具体方法我们放在下一讲里再专门介绍。

