面对快速变化的外部环境，敏捷方法不尝试在几个月的时间跨度上完全预测项目进展，而是采用短迭代方式，频繁发布可工作的软件。用户故事和迭代，是敏捷方法中管理需求和项目的基本方法。

* * *

“戚主任，这个问题我们再调一调，花不了多少时间，就这两天，保证给您改好。”何晓东拿着电话，满脸堆笑，似乎希望他的笑意能感染电话线另一头的听者。

“两天两天，你们老是这个样子，怎么做点事情就不能按起初定好的时间完成呢？我再给你三天时间，这个星期五之前，把所有的修改都改完上线。要是星期五还完不成，你就带着人再到局里来驻场吧！”不等何晓东回答，戚红军“砰”的一声挂了电话。

打完电话，戚红军端起茶杯，慢慢喝了两口，脸上并没有怒容。他在杭州工商局信息中心从科员干到主任，经他手采购的信息化项目大大小小也有几十个，项目的拖拖拉拉实在看得太多了。尤其是软件开发、系统集成的项目，严重的可以超期几个月。听其他地市兄弟机关交流，整个项目彻底失败、完全不能上线使用的情况也不罕见。相比之下，北大青鸟这个项目的进度已经不算坏，至少第一期赶在年底前把年检和注册功能都上线用了起来。对何晓东这个团队的能力，他还算有些信心，在电话里吓唬一下就行，估计他们完成这个阶段的修改问题不大。

这种信心是在过去几个月的项目过程中逐渐形成的。这个项目签给北大青鸟是在夏天，戚红军本来期望起码到 11
月以后才会看到软件，再集中提一批修改意见，这是软件项目典型的节奏。不料这个项目才做了一个月，就开始邀请他看功能展示，随后每过两周就给他做一次展示，听取他的意见。起初的两三次展示，看到的功能还很粗糙，等界面美工设计加上之后，就有了一点成型的样子，戚红军感觉能看到这个系统在慢慢生长成该有的样子。他给项目组提的意见，起初多是在纠正他们理解上的偏差，后来常常是在展示和试用的过程中发现自己的想法有所偏差、或是跟业务口的同事对着测试软件交流后有了更好的想法。这个节奏做到
11 月，虽然这支团队压力不小，其实戚红军并不特别担心：照这个势头，即使到年底完不成所有功能、或者有些小 Bug，这个项目大差不差是能成功的。

回想着这个项目的过程，戚红军又拿起手边一份打印出来的项目月报。这是另一家供应商承接的另一个软件实施项目，月报上写着“开发完成 80%”、“项目整体进度
60%”。可是直到今天，戚红军连这个软件的样子都还没见到一眼。那么这份报告里写的
80%、60%，到底是什么意思呢？现在项目的时间倒是已经过去了大半，剩下的工作能在 40% 时间里完成吗？想到这儿，戚红军起身拿起外套，打算去这家公司走走。

![](https://images.gitbook.cn/f453b490-133d-11e9-b788-6d43e14d3bb3)

* * *

### 迭代：敏捷项目管理的基本单元

软件工程理论将软件生产过程中的活动分为 5 大类，称为 5 种“框架活动”，它们分别是：

  * **沟通** ：理解利益相关者的项目目标，并收集需求以定义软件特性和功能；
  * **策划** ：定义和描述软件工程工作，包括需要执行的技术任务、可能的风险、资源需求、工作产品和工作进度计划；
  * **建模** ：利用模型来更好地理解软件需求，并完成符合这些需求的软件设计；
  * **构建** ：编码（手写的或者自动生成的），并测试以发现编码中的错误；
  * **部署** ：软件（全部或者部分增量）交付到用户，用户对其进行评测并给出反馈意见1。

经典的软件工程并不强制要求这 5 种框架活动以顺序的方式执行，较晚近的软件工程理论著作甚至会明确指出，以迭代的、多次重复的方式执行 5
种框架活动是可行的2。

但在较早的软件工程理念中，“各活动顺序执行”是一个广泛存在的、甚至不言自明的假设；如果在进行较为靠后的活动时不得不回过头去重复进行较为靠前的活动，那多半是因为前面的工作没有做好而造成了返工，这样的情况虽然在实践中总会出现，但被视为是一种应该可以避免的异常情况。例如在
2001 年的一本软件工程教材中，作者这样写道：

>
> 软件开发包含下列活动：需求分析和定义，交流设计，程序设计，写程序（程序实现），单元测试，整体测试，系统交付，维护。理想条件下一次进行一项活动，当到达列表尾部时，人已经完成了一个软件项目。3

这种认为软件生产的各个活动应该顺序执行、正常情况下不应回头重复执行前序活动的软件工程模型，被称为 **瀑布模型** 。

![](https://images.gitbook.cn/ff73ec80-2541-11e9-aa44-eb3c50edd070)

这种模型的起源可以追溯到 1956 年，最初应用在防空系统“贤者”的软件开发中4，“瀑布”（waterfall）这个词则是在 1970
年首次被用于描述软件开发方式的5。瀑布模型起初的提出，至少有部分原因是由于这些早期的 IT 项目（其中很多是军方项目）
**需要建设的不仅是软件，而是包含软硬件在内的整个计算机系统** 。

在这种项目的早期阶段，没有办法开始启动软件代码的编写，因为执行软件的硬件尚未设计制造出来，软件代码即使编写出来也无法编译，有时连编程语言都必须到项目后期才能选定。因此在这些项目的大半时间里，软件团队只能不断地细致推敲软件的设计，寄望在硬件设计制造出来之后尽可能快而准确地完成软件的编码和测试6。

即使后来 IT
项目只需要在通用的硬件上开发软件，计算机硬件资源的短缺仍然制约软件开发者的工作方式，使他们不能随时地编译和运行自己开发的软件。而瀑布模型则通过投入更多的精力在前期的需求分析和设计上来减少编译和测试软件的次数，因此是一种
**节省计算资源** 的软件开发方式。

随着摩尔定律的作用和个人电脑的普及，时至 21
世纪，计算能力已经不再是一种稀缺的资源。与此同时，软件生产过程的灵活性不足、无法应对市场环境快速的变化、无法满足消费者对创新和定制的要求，成为了更为
**显著的问题** 。

与制造业一样，IT 业在新千年也遭遇了“快速、残酷与不确定的变化”带来的挑战。
**整套极限编程的实践都是为了应对这一趋势，其中最关键的实践，就是快速的迭代** ，即在很短的时间内完整执行软件生产的 5
种框架活动、并在整个项目周期内多次重复这一过程。

对于 **快速的迭代** 应该多快、每个迭代周期应该多长，并没有统一的答案。一般认为，迭代周期应该控制在 1~4 周：短于 1
周的迭代会使团队过于频繁地进行迭代的启动、展示和回顾，打乱他们的“心流”状态；长于 4 周的迭代又不利于经常获得反馈。

早期的极限编程团队倾向于采用 **3 周** 的迭代7，Scrum 实践者们也曾经推荐 3 周的迭代8。不过“鲍勃大叔” Robert Martin
则推荐了为期 2 周的迭代9，并且至少不晚于 2003 年，已经有实践敏捷的团队采用长度为 1 周的迭代10。

![](https://images.gitbook.cn/288080a0-13fb-11e9-8f0d-970f3b927d4e)

ThoughtWorks 某项目的范围燃起图，迭代长度为 1 周（图片来源：《软件开发沉思录》，图 8.1）

不论迭代周期的长短，迭代开始时应该允许客户选择优先级最高的需求（被称为“用户故事”或简称“故事”）进入迭代计划、并澄清其相关的需求细节，迭代结束时应该给客户演示当前可运行的程序，要求客户基于可运行的程序提供评价和反馈11。

以这种方式，一次迭代至少包含软件生产过程中的沟通、策划、建模、构建活动，以及部分的部署活动——可运行的软件程序至少应该被部署到一个可以给客户展示的环境，但并不一定总是被发布到真实的生产环境。

![](https://images.gitbook.cn/995c1fd0-13e9-11e9-920f-01d395b061df)

尽管敏捷开发方法追求更频繁地发布产品到生产环境，但实际情况并不一定允许更频繁的发布，因此实际上敏捷方法满足于提高软件的“可发布性”——在需要发布的时候能尽快地发布12。前文介绍的持续集成实践，最重要的价值就在于在快速的迭代中
**随时保持软件处于可用、可发布的状态** 。

在针对一系列需求进行沟通、策划、建模、构建、部署的完整生产流程之外，一些敏捷实践者还提倡在每个迭代结束时进行 **回顾**
（retrospective），讨论团队在迭代中哪些事做得好、哪些事做得不够好，从而及早识别团队运作中的问题，并在后续迭代中做出改进。加上回顾这个实践之后，以迭代方式不断完善的不仅是软件产品，还有开发软件产品的团队13。

### 敏捷方法如何管理需求：用户故事

使快速的短迭代成为可能的，除了持续集成（以及自动化测试）所提供的保持软件随时可用、可发布的技术能力，另一项不可或缺的能力是 **需求管理**
：如果采用瀑布模型中常见的“华丽而厚重的需求文档”，势必很难在 1~4 周的迭代中快速应对变化做出调整。

敏捷实践者们认识到他们“不能完美地预测软件开发项目”，因此他们不再把需求文档视为软件需求的权威、准确表述，而是将分析需求的过程视为“一种协同工作的方式”，不追求“在项目开始时就做一套包罗万象的决策”，而是建立“一个获取信息的过程，越早越好，越频繁越好”14。这种分析、记录需求的方式和过程的载体，就是
**用户故事** （或简称“故事”）。

《敏捷宣言》的签署人之一 Ron Jeffries 将用户故事的特征概括为 **3 个 C**
：卡片（Card）、对话（Conversation）和确认（Confirmation）15。后面两个“C”清楚地体现了用户故事作为一种协作方式的定位：它不仅仅是一份文档，更重要的是用这份文档来承载需求获取、澄清、细化、开发、验收整个过程中的信息传递——理论上，所有这些交互都发生在为期
1~4 周的一次迭代中。

**卡片**
则是用户故事的常见形态：早期常见的是纸质的卡片，后来一些适用于敏捷项目的管理软件也延用了这个隐喻。这种卡片的形式，很可能与源自日本的精益生产方法、尤其是其中的拉动式生产系统（“看板”系统）有着渊源16。

为了用故事卡拉动软件生产过程的流动，需求的拆分和故事卡的编写是有讲究的。极限编程实践者们提出了 6 个单词的指导原则 **INVEST**
17，即高质量的故事应该是：

  * 独立的（ **I** ndependent）：尽量避免故事间的相互依赖，从而降低优先级排序和制定迭代计划的难度；
  * 可讨论的（ **N** egotiable）：故事不必包含所有具体需求，只是对功能的简短描述，细节将在客户团队和开发团队的讨论中产生；
  * 有价值的（ **V** aluable）：故事必须呈现用户（软件的使用者）或客户（购买软件的人）关心的某些价值；
  * 可估计的（ **E** stimable）：开发人员应该能至少大致估计故事的大小和开发的工作量；
  * 小的（ **S** mall）：故事的大小应该适合制定迭代计划，通常这是指一个开发人员能在一个迭代内完成多个故事的开发；
  * 可测试的（ **T** estable）：故事必须是可测试的，即有明确的边界定义故事是否完成。

![](https://images.gitbook.cn/7ede7060-134c-11e9-bc0e-79d07a81907b)

从这个指导原则可以看到，不同于瀑布模型中使用的需求文档， **用户故事并不要求对一块软件功能做完整的描述**
，同时也允许、甚至鼓励对同一块软件功能进行多次加工，在多次迭代中不断完善软件功能。

瀑布模型中的需求文档（例如用例文档）描述的是软件的结果状态，用户故事则描述了软件逐步迭代生长的过程。用户故事，以及极限编程中围绕用户故事进行的需求分析、项目计划、测试验收等实践，都是服务于
**短迭代交付模型** 。

### 结语

对于“为什么要以短迭代方式交付软件”这个问题，极限编程给出的答案是 **应对风险**
：软件项目的进度可能延迟、甚至整个项目被取消；软件团队可能误解了用户的需求，业务的变化也可能导致需求变更。极限编程通过快速的短迭代，及早交付价值最大的功能，并及时获得真实有效的反馈，从而消减上述风险18。

另一些敏捷实践者还指出，采用短迭代方式交付软件可以提早软件上线运营、并创造经济效益的时间，从而改善整个项目的现金流。

为了让短迭代交付方式成为可能，极限编程提出了一系列相互关联的实践：

  * 需求管理角度：以 **用户故事** 的形式分析和记录需求，使软件需求以一种允许乃至鼓励多次迭代交付的形式出现在软件团队面前；
  * 项目管理角度：围绕用户故事开展的 **迭代管理** 方法，包括计划会议、成果展示、每日站会等，加上对进度与质量的度量和可视化呈现，使项目随时处于透明、受控的状态；
  * 配置管理角度：以 **持续集成** 为核心，对修改动作的频度和方式作出了严格要求，使软件在迭代演化的过程中始终保持可用状态；
  * 质量管理角度： **测试驱动开发** 使软件获得很高的自动化测试覆盖率，在自动化测试的保护下，通过频繁而小步的 **重构** 改善软件内部质量，从而消减软件频繁改动带来的质量风险。

尽管 CMM 热潮指出中国软件业在需求管理、项目管理、配置管理、质量管理这 4 大领域存在明显差距，但 CMM
的实践者们把主要精力放在了快速通过等级认证从而获得政府补贴，在给出切实有效的实践指导方面着力不多。就在 CMM
留下的空白之中，一些视野领先的实践者看到，以极限编程为代表的敏捷方法针对这 4 大领域给出了明确的、具有可操作性的实践指导。

这个问题与答案的意外相遇，或许能解释为何 CMM 与极限编程这两个后来近乎水火不容的软件过程方法，却几乎在同一时间段受到了中国从业者较多的关注。

不过，当这些最早接触到极限编程的从业者从国外的网上技术社区走回国内的行业现实，他们会更加清晰地感受到现实的阻力。快速迭代交付这个敏捷方法的核心要件，在当时的中国软件行业中远未得到广泛认同。这个基本出发点的缺失，就注定了以极限编程为代表的敏捷方法在当时的中国是水土不服的。在快速集中的发声之后，敏捷在中国即将经历长达数年的蛰伏期。

### 参考文献

1 （美）普雷斯曼著.软件工程：实践者的研究方法 原书第7版[M].机械工业出版社,2011.  
2 ibid  
3 Pfleeger, S.L., 2001. Software Engineering: Theory and Practice.  
4 Symposium on advanced programming methods for digital computers. (1956).
[Washington, D.C.]: Office of Naval Research, Dept. of the Navy.  
5 Royce, W.W., 1987, March. Managing the development of large software
systems: concepts and techniques. In Proceedings of the 9th international
conference on Software Engineering (pp. 328-338). IEEE Computer Society Press.  
6 （美）麦克布林著.软件工艺[M].人民邮电出版社,2013.  
7 （美）贝克（Beck,K.）著,雷剑文.解析极限编程 拥抱变化 第2版[M].电子工业出版社,2006:97.  
8 （瑞典）克里伯格著,李剑译.硝烟中的Scrum和XP 我们如何实施Scrum[M].清华大学出版社,2011:16.  
9 （美）Robert C.Martin著,邓辉译.敏捷软件开发 原则、模式与实践[M].清华大学出版社,2003:18.  
10 ThoughtWorks公司编著.软件开发沉思录 ThoughtWorks文集[M].人民邮电出版社,2009.  
11 （美）Robert C.Martin著,邓辉译.敏捷软件开发 原则、模式与实践[M].清华大学出版社,2003:20.  
12 （英）亨布尔,（英）法利著.持续交付 发布可靠软件的系统方法[M].人民邮电出版社,2011:104.  
13 ThoughtWorks公司编著.软件开发沉思录 ThoughtWorks文集[M].人民邮电出版社,2009.  
14 （美）科恩著.用户故事与敏捷方法[M].清华大学出版社,2010.  
15 [美]Ron Jeffries等著;袁忠国译.极限编程实施[M].人民邮电出版社,2002.  
16 （美） Mary Poppendieck,Tom Poppendieck著,朱崇高译.敏捷软件开发工具 精益开发方法[M].清华大学出版社,2004.  
17 [Bill Wake.INVEST in Good Stories, and SMART
Tasks](https://xp123.com/articles/invest-in-good-stories-and-smart-
tasks/)[EB/OL].  
18 （美）贝克（Beck,K.）著,雷剑文.解析极限编程 拥抱变化 第2版[M].电子工业出版社,2006:4.

### 畅聊技术历史与人生

我们希望订阅课程的朋友们可以一起把酒言敏捷，分享技术世界的一切趣事，畅聊各自的技术人生。《敏捷中国史》是普通 IT
人形塑历史的故事，也是永远不会完结的技术旅程。你可以将自己的想法发表在评论区，也可以加入《敏捷中国史》交流群，小到我们一起完善这部作品，大到共同创造未来更好的
IT 世界。（入群请加 GitChat 小助手伽利略的微信，ID 为 GitChatty6，回复关键字「246」）

![](https://images.gitbook.cn/f5ab9450-3527-11e9-af4a-bd2de5905629)

分享上面的《敏捷中国史》阅读卡片，跟朋友一起了解中国软件开发方法的进化和一代程序员自我突破的故事。

