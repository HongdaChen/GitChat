### 从空间映射的角度再来看方程组

这一篇我们来系统的聊一下解方程组的问题。这看上去像是中小学生干的事儿。例如我们来解一个三元一次方程组，老师会告诉我们：如果有三个未知数，那么方程组里就需要有三个方程来对其进行求解，如果方程的个数不足三个，那么方程的解就不唯一，如果方程组的个数超过了三个，方程组就无解。

对这段话是不是有一些印象？这是一种非常朴素的理解方法，至于说为什么朴素，一方面它的确说明了一些问题，但是实际上描述并不完备、准确。

在这一讲里面，我们就把解方程组和前面反复讨论的空间映射结合起来思考，利用矩阵的工具来解方程组。首先我们学习一下如何用矩阵来描述一个线性方程组。

$$a_{11}x_1+a_{12}x_2+a_{13}x_3+...+a_{1n}x_n=b_1$$
$$a_{21}x_1+a_{22}x_2+a_{23}x_3+...+a_{2n}x_n=b_2$$ $$......$$
$$a_{m1}x_1+a_{m2}x_2+a_{m3}x_3+...+a_{mn}x_n=b_m$$

上面是一个 n 元线性方程组，一共包括 m 个方程，这是一个通用表达，我们很容易的把它转化成一个矩阵乘法的形式：

$$\begin{bmatrix} a_{11} & a_{12}&a_{13}&...&a_{1n}\\\ a_{21} &
a_{22}&a_{23}&...&a_{2n}\\\\...&&...\\\a_{m1} &
a_{m2}&a_{m3}&...&a_{mn}\end{bmatrix}\begin{bmatrix} x_1\\\
x_2\\\x_3\\\\...\\\x_n\end{bmatrix}=\begin{bmatrix} b_1\\\
b_2\\\\...\\\b_m\end{bmatrix}$$

我们令：

$$A=\begin{bmatrix} a_{11} & a_{12}&a_{13}&...&a_{1n}\\\ a_{21} &
a_{22}&a_{23}&...&a_{2n}\\\\...&&...\\\a_{m1} &
a_{m2}&a_{m3}&...&a_{mn}\end{bmatrix}$$ $$x=\begin{bmatrix} x_1\\\
x_2\\\x_3\\\\...\\\x_n\end{bmatrix}$$ $$b=\begin{bmatrix} b_1\\\
b_2\\\\...\\\b_m\end{bmatrix}$$

这样就转换成了我们熟悉的 Ax=b 矩阵的乘法形式。通俗的讲，解方程就是已知等号坐标的系数，也就是矩阵 A 和右边的向量
b，求解等号左侧的未知数，也就是向量 x 的过程。此时此刻，解方程的问题就转化为了之前的空间映射问题：已知目标空间的向量 b，和描述空间映射的矩阵
A，我们反过来去寻找位于原空间中映射过来的向量 x。

### 究竟由谁决定方程组解的个数

如果方程组有解，满足 Ax=b 等式成立，向量 b 就是矩阵 A 的各列的线性组合，换句话说只有 b 在矩阵 A
的列空间上，才能满足方程组有解。那么矩阵的秩 r 就在里面扮演了至关重要的作用。我们就来分析一下矩阵的秩 r，行数 m 以及列数 n
和方程组解的个数的关系。

为了揭示问题的本质，我们再次回顾一下 m、n、r 三个字母的几何内涵。

  * r，矩阵的秩，代表了矩阵列空间的维度，也就是映射后的向量集合构成的子空间维度。
  * m，矩阵的行数，即是映射后整个目标空间的维度（再次提醒，注意区别目标空间和映射后向量的构成空间之间的区别）。
  * n，矩阵的列数，就是映射前原空间的维数。

明确了这些，我们分四种讨论。

#### 情况一：r=m=n

这描述的是一个方阵，而且是满秩矩阵。这首先意味着原空间和列空间维数相等，都是 $R^r$ 空间，映射的过程不存在空间的压缩；同时目标空间和列空间等维，也都是
$R^r$ 空间，意味着目标空间 $R^m$（也就是 $R^r$）中的任意一个向量都在矩阵 A
的列空间上，这意味着什么？意味着在这种情况下，方程组一定有解，且仅有一个解。

在等式推导上，由于满秩方阵 A 可逆，我们对方程组 Ax=b 左右两侧同时乘以 A 的逆矩阵 $A^{-1}$，就能得到解向量的表达式：

$$Ax=b \Rightarrow A^{-1}Ax=A^{-1}b \Rightarrow x=A^{-1}b$$

#### 情况二：r=m<n

此时我们不再只拘泥于“矮胖”这个直观的理解层面，我们还是从空间维度来分析。r=m 意味着目标空间是一个 $R^m$ 空间，而列空间和目标空间维数相等，同样是
$R^m$ 空间，同样说明目标空间里的所有向量都位于矩阵 A 的列空间上，因此方程组一定有解。而同时有
r<n，意味着列空间的维度小于原空间的维度，即映射存在空间的压缩。因此 A 是一个多对一的空间压缩矩阵，方程组有解，且解有无数个。

至于说解的形态和表示方法，我们后面马上详细讨论。

#### 情况三：r=n<m

r=n 意味着，映射后的列空间和原空间的维数相等，都是 n，即如果在列空间上任选一个向量 b，在原空间中与之对应的解向量 x 是唯一的。但是请注意，由于
r<m，列空间的维度小于目标空间的维度，列空间仅仅是目标空间 $R^m$ 的一个子空间，因此问题来了，如果我们在目标空间中挑选的 b
向量不在列空间上，那么方程就无解。因此在这种情况下，方程组要么无解，要么有唯一解，区分的原则就是 b 向量是否在 A 的列空间上。

#### 情况四：r<n 且 r<m

最后一种情况要复杂一些，一方面 r<n，列空间的维度要小于原空间，对应的是空间压缩映射，与此同时，列空间的维度又小于目标空间，是目标空间 $R^m$
的子空间。因此它集中了情况二和情况三的特点：即，可能存在无解的情况，但又可能存在无数个解的情况。这同样取决于向量 b 的位置，如果 b 位于矩阵 A
的列空间上，那么方程组有无数个解，如果目标空间中的向量 b 位于列空间外，则方程无解。

这里我们很有必要举一个实例来说明，矩阵 $A=\begin{bmatrix} 1& 2\\\ 2
&4\\\3&6\end{bmatrix}$，这个例子中两个列向量线性相关，因此 r=1，同时 m=3，n=2，因此原空间是 $R^2$ 平面，目标空间是
$R^3$ 空间，列空间是一个一维直线，如图 1 所示，如果 b 向量在列空间对应的那条直线上，则方程组有无数组解；否则方程组无解。

![图1.
r<m且r<n的情况](https://images.gitbook.cn/ace11c30-db63-11e9-bbea-358bf3147161)

### 如何表示方程组的解

#### 从空间的角度理解

当方程组有唯一解的时候，它的解就是一个向量：

$$\begin{bmatrix} x_1\\\ x_2\\\x_3\\\\...\\\x_n\end{bmatrix}$$

这是唯一的表达方式。

但是如果方程组有无数种解，显然我们无法将其全部罗列出来，具体应该如何表达呢？我们还是从解的集合意义出发。

当方程组有无数个解的时候，实质上就构成了一个解的空间。我们的目标就是要找到这个解空间的描述方式，我们的思路是：首先任意找一个满足方程组的解，也就是解空间中的一个任意点，我们称其为特殊解
$x_p$，此时满足 $Ax_p=b$。

然后我们转而去考虑零空间。根据定义，零空间中的任意点 $x_s$ 满足 $Ax_s=0$，那么此时就有 $Ax_p+Ax_s=b+0 \Rightarrow
A(x_p+x_s)=b$。这意味着什么？意味着解空间中任意一个解向量与零空间中任意一个向量相加的结果也是解向量，用向量相加的几何意义来描述就是：零空间里的某个向量沿着这个特解向量
$x_p$ 进行移动，移动后的结果是另外一个解向量。那么整个零空间沿着这个特殊解向量 $x_p$ 进行移动，其结果就是我们要找的解空间了。

因此，我们需要转而去找零空间的描述方式，那就回到之前的套路了：找到零空间的一组基：$e_1,e_2,...,e_{m-r}$，这组基的线性组合就是零空间的表达方式：$x_n=c_1e_1+c_2e_2+...+c_{m-r}e_{m-r}$。

最终方程组的解就表示成为：$x=x_p+x_n=$ $x_p+c_1e_1+c_2e_2+...+c_{m-r}e_{m-r}$，目标达成。

最后说一下：当 A 是一个满秩方阵的时候，它的零空间是 0 向量，因此只有唯一解，这样就可以作为上面讨论的无数种解的一种特殊情况了。

#### 实例说明

我们举一个例子：

$$x_1+2x_2+3x_3+4x_4=6$$ $$x_1+3x_2+5x_3+7x_4=8$$

我们将其转化为矩阵相乘的形式：

$$\begin{bmatrix} 1& 2&3&4\\\ 1 &3&5&7\end{bmatrix}\begin{bmatrix} x_1\\\
x_2\\\x_3\\\x_4\end{bmatrix}=\begin{bmatrix} 6\\\ 8\end{bmatrix}$$

矩阵 A 中，r=2，m=2，n=4。属于 r=m<n 的情况，因此这个方程有无数个解。按照我们的步骤，我们先找一个满足方程组成立的特殊解：为了简单，我们让
$x_3=x_4=0$，这样就得出了，$x_1=2,x_2=2$，特殊解 $x_p=\begin{bmatrix} 2\\\
2\\\0\\\0\end{bmatrix}$。

再来求零空间 N(A) 的表示，通过维数定理我们求得零空间的维度是 $n-r=4-2=2$，因此我们只用找到满足

$$\begin{bmatrix} 1& 2&3&4\\\ 1 &3&5&7\end{bmatrix}\begin{bmatrix} x_1\\\
x_2\\\x_3\\\x_4\end{bmatrix}=\begin{bmatrix} 0\\\ 0\end{bmatrix}$$

成立的两个线性无关的解向量作为基向量即可。

我们求得两个线性无关的解向量：

$$e_1=\begin{bmatrix} -1\\\ 0\\\3\\\\-2\end{bmatrix}，e_2=\begin{bmatrix} -2\\\
3\\\0\\\\-1\end{bmatrix}$$

因此零空间的表示方法为：

$$x_n=c_1e_1+c_2e_2=c_1\begin{bmatrix} -1\\\
0\\\3\\\\-2\end{bmatrix}+c_2\begin{bmatrix} -2\\\ 3\\\0\\\\-1\end{bmatrix}$$

最终方程组的解的表达式为：

$$x=x_p+x_n$$ $$=\begin{bmatrix} 2\\\
2\\\0\\\0\end{bmatrix}+c_1\begin{bmatrix} -1\\\
0\\\3\\\\-2\end{bmatrix}+c_2\begin{bmatrix} -2\\\ 3\\\0\\\\-1\end{bmatrix}$$

当然表达式的写法各有不同，但实质上都对应着同一个空间。

### 利用 Python 求解线性方程组

最后我们来用 Python 求解下面这个线性方程组。

$$x_1+2x_2+3x_3=14$$ $$x_1-x_2+4x_3=11$$ $$2x_1+3x_2-x_3=5$$

**代码片段：**

    
    
    import numpy as np
    from scipy import linalg
    
    A = np.array([[1, 2, 3],
                  [1, -1, 4],
                  [2, 3, -1]])
    
    y = np.array([14, 11, 5])
    
    x = linalg.solve(A, y)
    print(x)
    

**运行结果：**

    
    
    [ 1.  2.  3.]
    

通过代码，我们得到了方程组的 $x=\begin{bmatrix} 1\\\ 2\\\3\end{bmatrix}$。

