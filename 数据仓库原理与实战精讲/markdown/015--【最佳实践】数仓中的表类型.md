### 维度建模中表的类型

在维度建模中，表类型分为事实表、维度表，而事实表又可以细分为事务事实表、周期快照事实表、累积快照事实表。

#### **事实表**

事实表存储的数据一般是指一个现实存在的业务对象，比如用户，商品，商家，销售员等等，属于查询结果中的核心数据。

![](https://images.gitbook.cn/400dbfc0-f00f-11ea-b2cc-b183c5e37897)

#### **维度表**

维度表一般是指对应一些业务状态，代码的解释表。也可以称之为码表。在查询过程中，对数据起到筛选、组织作用。通常使用维度对事实表中的数据进行统计、聚合运算。如订单状态表，商品分类表，在查询时可以通过订单状态或者商品分类来筛选数据，也可以通过这两个维度对数据进行聚合运算。

![](https://images.gitbook.cn/4f11e550-f00f-11ea-80b6-61caae27bd5a)

![](https://images.gitbook.cn/60097670-f00f-11ea-80b6-61caae27bd5a)

#### **事务事实表**

事务事实表是事实表的一种。它的数据特点是，随着业务不断产生，而且一旦产生不会再变化，如交易流水、操作日志、出库入库记录。

对事实事实表的操作只存在插入，而不存在修改。

![](https://images.gitbook.cn/6e76da40-f00f-11ea-affc-a54214209ff7)

#### **周期快照事实表**

周期快照事实表的数据，随着业务周期性的推进而变化；主要用于完成间隔周期内的度量统计，如年初至今的下单金额（年累计下单金额）、当前季度至今的下单金额。

使用周期 + 状态度量的组合，如年累计下单金额，年是周期，下单金额是量度。

对周期快照事实表的操作是插入，也不存在修改的现象，只需要将当天完成的计算数据追加到当日的分区中即可。

![](https://images.gitbook.cn/83c51b50-f00f-11ea-a374-77fb7954ed83)

#### **累积快照事实表**

累积快照事实表，用于记录不确定周期的度量统计，与固定周期的周期快照事实表不同，它完全覆盖一个事实的生命周期，如订单状态表。订单会经历下单、支付、确认收货三个过程，确认收货后订单已完成，其生命周期也就结束了。但它的周期不固定，如果使用事务事实表进行记录的话，最终会存放三条数据。

![](https://images.gitbook.cn/9637b3b0-f00f-11ea-80b6-61caae27bd5a)

而累积快照事实表不同的是，它最终只保留一条数据。

![](https://images.gitbook.cn/a5eb5320-f00f-11ea-8755-9ff4c3d0bc34)

累计快照事实表通常有多个时间字段，用于记录生命周期中的关键时间点。但与其它事实表不同的是，它只有一条记录，针对此记录不断更新。

### 拉链表

拉链表是数据仓库中很常见的一种表，它不属于任何数据仓库的表模型，仅仅是一种功能表。它用于记录每条信息的生命周期，用于保留数据的所有历史（变更）状态。

![](https://images.gitbook.cn/b6e6dbe0-f00f-11ea-a374-77fb7954ed83)

如图所示，通过生效开始日期、生效结束日期来记录数据的生命周期。生效结束日期为 9999-99-99
时，表示为最新的数据。当数据发生变动时，先进行修改旧数据的生效结束日期，然后再插入新数据。

拉链表是一种常用的记录历史数据的技术手段。

### 小结

这节讲了数据仓库中的几种表类型，在维度建模中，有事实表、维度表，其中事实表又分为事务事实表、周期快照事实表、累积快照事实表。不同的事务表适合的场景不同，其中事务事务表适合记录常见的流水信息表，周期快照事实表适合记录按照固定周期进行更新的数据表，而累积快照事实表适合不固定周期进行数据更新的数据表。

