### OLTP 系统建模方法

OLTP 系统，即在线事务处理系统；企业的业务数据库就是属于 OLTP 范畴，它主要的操作是随机读写。

为了保证数据的一致性、减少冗余，经常使用关系模型。在关系模型中，使用三范式来减少冗余。

![](https://images.gitbook.cn/a4819a20-ef84-11ea-a374-77fb7954ed83)

### OLAP 系统建模方法

#### **OLAP 系统概述**

OLAP 系统，即在线联机分析系统，数据仓库就属于这一类。它主要操作是分析查询；关注数据整合，以及分析、处理性能。

但是三范式的设计，在分析查询中会导致大量的 join 关联操作，而在集群中的关联会导致处理性能下降（涉及到大量的数据移动）。所以 OLAP
一般采用反范式的设计，去增加冗余以提升整体运算性能。

OLAP 根据数据存储的方式不同，又分为 ROLAP 系统、MOLAP 系统、HOLAP 系统。

#### **OLAP 系统分类**

**ROLAP（Relation OLAP，关系型 OLAP）** ，数据以二维表形式存储；存储系统一般为
RDBMS，功能上更注重分析运算，所以会使用关系模型来提升分析性能。

**MOLAP（Multidimensional OLAP，多维型 OLAP）**
：预先进行聚合计算，使用多维数组（矩阵）的形式保存数据结果，以空间换时间，加快查询分析时间。因为将查询的结果提前进行了计算，所以对于相同的查询、分析任务，可以直接返回结果，而不必进行等待。但预计算需要花费一定的时间，且需要一定的额外存储空间。

**HOLAP（Hybrid OLAP，混合架构的 OLAP）** ：ROLAP 和 MOLAP
两者的集成；如低层是关系型的模型，高层是多维矩阵型的；查询效率高于 ROLAP，低于 MOLAP。

#### **ROLAP 系统建模方法**

一般而言，狭义上的数据仓库的建模方法就是指 ROLAP 系统中的建模。因为传统数据仓库中本质就是
RDBMS，而大数据数据仓库也是使用二维表的形式对数据进行组织。

典型的数据仓库的建模方法有 ER 模型、维度模型、Data Value、Anchor。它们的特点如下图所示。

![](https://images.gitbook.cn/cad2b6f0-ef84-11ea-b2cc-b183c5e37897)

其中 ER 模型是比较经典的一种数据仓库模型，它与 OLTP 系统的 ER 模型有所区分。而 Data Value、Anchor 模型则是 ER
模型的衍生。

但 ER 模型、DataValue、Anchor 模型不太适合互联网的快速构建与迭代的场景，而且构建成本也较高。

维度模型是最流行的数据仓库建模经典，也很贴合现在互联网企业的场景，适合快速构建数据仓库，并有较好的大规模复杂查询分析的性能。所以接下来我们主要去讲解维度建模。

#### **MOLAP 系统建模方法**

MOLAP 的建模方法，是 MOLAP 系统通过预计算，然后将结果保存为某种数据结构，这种数据结构称为模型。在不同的 MOLAP
系统中，它们的实现各不相同。比较经典和公认的模型是 Kylin 中的 Cube——数据立方体。之后会介绍 MOLAP 模型的内容。

### 小结

本节主要讲解了 OLTP、OLAP 系统的异同，并且介绍了几种 ROLAP 的经典建模理论，简单提及了 MOLAP 系统建模。

MOLAP 和 ROLAP 的模型目的一致，就是为了加快分析、查询性能，只不过实现的方法不同而已，导致其侧重、适用场景也不同。

ROLAP 主要是为了解决原始数据的三范式对分析计算性能带来的问题，保留原始数据，更为灵活，保证大批量分析任务的运算效率。所以它更多出现在 DWS
层，作为跑批任务的性能支柱。

而 MOLAP 主要是为了解决对数据的多维度快速分析，更适用于业务系统、报表工具对结果表的分析查询，一般不保留原始数据，不太灵活。所以它更多出现在 ADS
层，作为其他系统的查询接口。

