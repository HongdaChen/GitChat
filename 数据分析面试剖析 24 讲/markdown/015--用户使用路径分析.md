用户使用路径分析，也称为用户行为路径分析，是互联网产品数据分析的重要分析模型，下面我们开始本篇的内容。

### 产品用户路径迭代体验

下面，我们以国内两款被大家经常使用的 App 为例，来看看随行业变化和用户使用习惯的变化，引起 App
自己本身产品迭代，以及不同领域产品对用户使用路径变化的趋势。

先看看支付宝，自上线以来，从单一的定位网络支付，到目前核心功能已经发生巨大的变化，目前主要集中在理财、首付款和出行。

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201207003107852.jpg?x-oss-
process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MzMwNjQz,size_16,color_FFFFFF,t_70#pic_center)

如上图所示，左侧是 2017 年支付宝顶部导航和 2020
年导航的变化，随着支付宝功能模块越来越多，且想占领出行领域的巨大市场，我相信这样的调整本身就是基于大数据统计得来的，当所有使用支付宝的用户通过支付宝支付公交、地铁、12306
购票、网约车、出租车、共享单车费用，且这个使用率一直不断增大的时候，出行模块势必会成为其核心功能模块之一。

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201207003127284.jpg#pic_center)

同样是支付宝，再看一个底部导航变化，几年前支付宝多次通过春晚红包使劲浑身解数想在社交领域分得一块蛋糕时，然而苍天助微信不助支付宝啊，显然没有成功，但是最近几年，我们看到，支付宝慢慢走向理财领域了，而弱化了社交朋友的功能。

上面例子讲的是支付宝的用户使用路径变化，下面我们再来看另一个例子，外卖起家的美团和支付宝之间的对比：

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201207003151317.png?x-oss-
process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MzMwNjQz,size_16,color_FFFFFF,t_70#pic_center)

从上图可以看出，这两年美团和支付宝的 App 长得越来越像，看起来像是一对“孪生兄弟”的感觉。 美团在不停地往 App
里加金融模块，支付宝则不停地加本地生活。最新版的美团
App，将“付款码”和“骑车”放在了首页的第一行，而支付宝，将“付钱”和“收钱”合并，首页新增“出行”。就顶部导航而言，美团和支付宝已经非常相似，所以笔者大胆预测，随着头部势力越发集中显著，未来美团和支付宝必有一战。

从上面的两个例子呢，主要是想说明几个观点：

  * 在互联网领域，单一核心功能的产品，会慢慢演变成多个核心功能，因为产品在不断扩大自己的护城河和边际；
  * 其次，随着行业巨变和用户使用习惯的变化，产品自身也会调整功能模块，其目的就是要让核心功能距离用户非常近，触手可得；
  * 最后，用户使用路径分析，很多产品前期可能使用预设计的路径，但是随着用户数据和行为数据越来越多，数据分析的价值就是通过数据分析，复现完整的用户转化率路径，并能够在此基础上挖掘和优化出更多有价值的路径。

### 什么是用户使用路径分析？

在企业实现数据化驱动业务的过程中，用户使用路径分析，通过还原用户使用路径发现用户的行为规律， 可以观察用户的主动访问路径与产品设计的路径是否一致，
可以帮助寻找产品存在问题的环节及改进的节点，如果用户在产品设计的主路径外发生行为的频率比较高，说明主路径设计不符合用户习惯，需要进行及时的优化迭代。

### 用户使用路径分析的价值

随着互联网巨头头部效应也来越明显，我们日常使用的各类 APP 最大的变化就是功能模块越来越多，用户的行为越来越多元化，很多 APP
可能不再局限于单一功能，可能是多个核心功能。在公司日常工作中，从管理层、产品、运营以及开发，很多时候，我们都希望了解一些问题，比如：

  * 用户从进入产品到离开产品做了什么？
  * 用户是否按照产品设计的主路径进行操作？ 
  * 用户在哪些路径节点上转化率高？哪些节点流失率大？
  * 用户离开预想的路径后，实际做了什么？

而想要知道这些问题的答案，用户路径使用分析就成为了关键，使用用户路径分析可以在指定某一个节点后，观察用户的后续行为路径行为。

例如，我们想分析电商 App 用户访问之后的路径，就可以通过统计用户访问的每一个节点的一些数据，例如：80%~85%
的用户进入了搜索框进行搜索，10%~20% 的用户去了购物车，0.5%~2% 的用户进行了注册等。

### 用户使用路径分析思路

从上面用户使用路径分析的定义可以看出，用户分析思路的一种常见方式就是在产品设计之初预先定义一条或多条路径，然后通过实际数据去验证；另外一种就是基于大数据统计发现，产品设计时没有料想到的，但通过数据分析挖掘出的用户实际习惯。所以，用户使用路径分析思路总结为：

先预设再数据验证：根据经验、或者行业已有的方式预先定义一条或多条路径，然后通过埋点等方式收集数据，根据数据形成相关漏斗模型，很直观的通过数据分析预先设定的路径是否合理。

先数据统计再验证：就是基于数据统计来发现除预先设计之外的其他用户使用路径。由于行业或者技术进步，一味地使用预先设定的用户路径可能会使产品慢慢失去竞争力和散失用户体验，而这个时候通过已有数据进行统计分析，就能帮助我们很快的发现用户的新访问路径，增强对于行业、技术变化所带来的用户使用习惯和产品上的变化。

我们举个例子：

对于传统的电商和 App 来说，比如淘宝和京东，用户使用 App 的习惯基本就是：

> 打开 App—搜索产品—浏览产品—加入购物车—支付下单成功—订单配送—结束

我们可以看到这样一个订单的生命周期要经过 7
个节点，用户距离下单支付成功很远，任何一个节点出问题，都会影响订单的成功率。但是这也是受到当时行业和技术的限制等，比如用户购物还没有现在这么方面和容易，快递还要凑单满减包邮，支付环境限制，搜索功能非常重等等。

但是，如今快递都是包邮，没有在关注快递费了，支付宝和微信等其他支付手段非常便捷，用户随时想买就买的使用习惯，使得最近几年异军突起的拼多多抓住了机会，整个拼多多的购买路径就是：

> 拼团（发起拼团）—下单支付成功—订单配送—结束

可以看出，拼多多优化得非常彻底，用户下单支付前只有一个节点，也就说用户想买就买，一旦决定买就能很快产生订单，从而增大了订单的转化率，彻底弱化了搜索，彻底去掉了购物车，拼团还让用户主动分享引起裂变，如果看懂了这里，相信大家对拼多多的成功也就一点也不惊讶了。

### 用户使用路径分析过程

下面，我们对用户使用路径分析过程做一个详细说明，首先是数据的收集，对于大多数产品都可以通过埋点或者日志来记录用户的详细行为信息，通过对特定功能模块和节点的记录，形成一定规则的数据，后续进行分析的时候，基本遵从节点筛选、数据关联、可视化和路径发现的步骤进行。

假定，我们以某电商平台为例，一段时间内，男女用户进入 App 首页的使用行为数据如下表所示：

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201207003402537.JPG#pic_center)

通过这个数据，我们可以发现，搜索和购物车是用户进入 App 最常使用的功能模块。

然后在此基础上，我们通过桑基图来进行可视化，这里使用 Python 3 和 pyecharts
进行数据可视化（这里数据可视化的过程，其实包括数据的关联，其次，可视化也可以选择漏斗图，但是我认为桑基图更直观）：

    
    
    import pandas as pd
    from pyecharts.charts import Sankey
    from pyecharts import options as opts
    df = pd.read_csv("single_node_data.csv",encoding='gbk')
    

这一步，我们引入相关包和加载数据。

    
    
    #获取类别型变量
    sex = df['性别'].values.tolist()
    node = df['节点'].values.tolist()
    #去重
    values = list(set(sex+node))
    #形成字典列表
    nodes = [{"name":v}for v in values]
    

这一步，需要把所有涉及到的节点去重规整在一起。

    
    
    links = []
    for tmp in df.values:
        tmp_dict = {}
        tmp_dict['source'] = tmp[0]
        tmp_dict['target'] = tmp[1]
        tmp_dict['value'] = tmp[2]
        links.append(tmp_dict)
    

这一步，把数据组织成 source-target-value 的字典格式，很清晰的描述了数据的流转情况。

    
    
    pic = (
        Sankey()
        .add('', #图例名称
             nodes,    #传入节点数据
             links,   #传入边和流量数据
             #设置透明度、弯曲度、颜色
             linestyle_opt=opts.LineStyleOpts(opacity = 0.3, curve = 0.5, color = "source"),
             #标签显示位置
             label_opts=opts.LabelOpts(position="top"),
             #节点之前的距离
             node_gap = 30,
        )
        .set_global_opts(title_opts=opts.TitleOpts(title = '单节点电商用户进入 APP 行为桑基图'))
    )
    pic.render('单节点电商用户进入 APP 行为桑基图.html')
    

最后一步， 数据准备完毕，以固定格式的绘图代码，结果如下：

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201207003603971.JPG?x-oss-
process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MzMwNjQz,size_16,color_FFFFFF,t_70#pic_center)

通过上图，我们可以看出，80%~85% 的用户进入了搜索框进行搜索，10%~20% 的用户去了购物车，0.5%~2% 的用户进行了注册等。

上图是涉及到两层的流转，如果要 3 层或者多层的图，怎么绘制呢？如下图所示：

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201207003625730.JPG?x-oss-
process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MzMwNjQz,size_16,color_FFFFFF,t_70#pic_center)

完整代码和数据，下载地址如下：

>
> [业务专题篇：用户使用路径分析源码下载](https://github.com/GitBookCn/soyoger/tree/main/codes/%E4%B8%9A%E5%8A%A1%E4%B8%93%E9%A2%98%E7%AF%87%EF%BC%9A%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E8%B7%AF%E5%BE%84%E5%88%86%E6%9E%90)

最后，关于 Python 绘制桑基图 Sankey，Pyecharts 不显示 HTMK 页面，桑基图只显示标题，原因总结如下三点：

  * nodes 中的“name”不要重新命名，否则会不识别，导致没有图；
  * links 中 source 和 target 对应的值一定要在 nodes 的 name 对应的值中，否则图中会不显示（但是不会报错）；
  * links 中 source 和 target 对应的值不能相同，否则图不显示。

### 总结

本篇主要介绍了用户使用路径分析的过程，这是非常实用的一个分析模型，在实际工作中如果做好了用户使用行为分析，对最终的转化率会非常有帮助，关于用户使用路径分析，常见数据转化率可视化有漏斗模型和桑基图，由于漏斗模型大家都非常熟悉，本节最后给出了基于
Python 和 pyecharts 绘制桑基图的方法，通过桑基图来启发数据分析师发现新的用户使用路径等。

