### 动态图模型的共性特征

从这一讲开始，我们来关注有向图模型，也就是贝叶斯网络模型中的一组典型案例——隐马尔可夫模型、卡尔曼滤波器和粒子滤波，这三个有向图模型都有一个统一的名字——动态图模型，它们拥有如下的通用概率图表达形式：

![图1
动态图模型通用概率图形式](https://images.gitbook.cn/8b4e4d10-8e94-11ea-861a-9398d62a6944)

我们明显可以发现，在上面的概率图中有几个很重要的要素：

  * 第一个：在这个模型中，我们拥有观测变量 $X$，以及隐藏变量 $Z$，代表了隐含状态；
  * 第二个：就是可以看出这个模型中明显包含了一条时间轴。

很显然，隐马尔可夫模型、卡尔曼滤波器和粒子滤波这三种具体模型承袭于动态图模型，那么它们显然都具备动态图模型的两个共同假设。

一个是基于隐变量序列 $Z$ 的，齐次马尔科夫假设：即 $Z_{t+1}$ 的取值只与 $Z_{t}$ 有关，而与
$\\{Z_1,Z_2,...,Z_{t-1}\\}$ 的各自取值均无关联。

$$p(Z_{t+1}|Z_t)=p(Z_{t+1}|Z_t,Z_{t-1},Z_{t-2},...,Z_{1})$$

另一个是基于同一组观测变量 $X_t$ 和隐含变量 $Z_{t}$ 的关系，即观测独立性假设：即观测变量 $X_t$ 的取值只与隐含变量 $Z_{t}$
有关，而与其他的观测变量、隐变量的取值均无关系。

$$p(X_t|Z_t)=p(X_t|Z_1,Z_2,...,Z_{T},X_1,...,X_{t-1},X_{t+1},...,X_T)$$

### 几种模型各自的区别

这两个假设是这三个模型的共性特征，那么它们的区别在哪呢？就在于观测变量 $X$ 和隐藏变量 $Z$
各自的变量分布形式，以及变量之间的关系上，这里我们先简要地说一下，具体会在各自模型介绍的章节中进行详细展开。

对于隐马尔可夫模型模型而言，要求隐变量必须是离散型随机变量，观测变量可以是离散的也可以是连续型的，相邻隐含变量 $Z_t$ 和 $Z_{t-1}$
之间的转移过程以及隐含变量 $Z_t$ 到观测变量 $X_t$ 的输出过程都遵循状态转移矩阵中的概率约束。

对于卡尔曼滤波器而言，情况就有所不同，隐含变量 $Z$ 和观测变量 $X$ 都是连续型随机变量，并且都符合高斯分布。同时 $Z_t$ 和 $Z_{t-1}$
之间的关系以及隐含变量 $Z_t$ 到观测变量 $X_t$ 的关系都是符合带有高斯噪声的线性关系。

而粒子滤波则具备更为一般性的情况，即隐含变量 $Z$ 和观测变量 $X$ 均不需要服从高斯分布，并且它们之间也不需要满足线性关系。

这里的文字性描述，大家看了肯定会感动非常抽象晦涩，不要着急，我们的目的只是想在动态图模型的开篇，提纲挈领地让大家对这三类具体模型有一个整体认知，有一个模糊的印象之后，大家在后面具体内容的学习过程中，目的性会更强一些。

### 动态图模型的重点问题

那么，我们在利用动态图模型的过程中，一般都会尝试去解决哪些问题呢？

  * 第一类大问题我们称之为学习（learning）：比如在隐马尔科夫模型中，我们会通过模型的观测值 $X$，利用 EM 方法去迭代探索模型的参数：初始状态分布向量 $\pi$，状态转移矩阵 $A$ 和发射矩阵 $B$。
  * 第二类大问题我们称之为推断（inference）：但它们本质上都是已知一组观测变量 $X$，对我们所感兴趣的后验概率进行估计，但是推断的问题当中又分了很多具体的细类。

在隐马尔可夫模型中，我们比较关心状态解码：

> 状态解码（decoding）是已知一组观测变量 $x_1,x_2,...x_t$，去推断最可能对应的一组隐状态
> $z_1,z_2,...,z_t$，实际上就是去估计后验概率 $p(z_1,z_2,...,z_t|x_1,x_2,...,x_t)$。

而针对我们的卡尔曼滤波或者粒子滤波主要有下面三类情形。

一种称之为滤波（filtering），它需要去求的后验概率的形式为：$p(z_t|x_1,x_2,x_3,...,x_t)$。

另一种就称之为是平滑（smoothing），它需要去求的后验概率的形式为：$p(z_t|x_1,x_2,x_3,...,x_T)$。

滤波和平滑的后验概率形式看上去挺像的，但是有一点本质的区别，如下图所示，滤波是从起始的 $t_1$ 开始，当得到第 $t$ 时间点的观测变量时，对 $t$
时刻的隐含变量 $Z_t$ 进行估计，所以我们可以看出，滤波的过程是随着时间的进行，动态实时进行的，因此滤波是一个在线过程，而平滑很显然不同，它是获得了所有
$T$ 时间点的观测变量后，对 $t$ 时刻的隐含变量 $Z_t$ 的概率进行估计。

![图2 滤波过程示意图](https://images.gitbook.cn/4157e7a0-8e96-11ea-a326-c7ef51ab79ae)

![图3 平滑过程示意图](https://images.gitbook.cn/5dc0b390-8e96-11ea-86f7-9b5ee2f8f4da)

第三类就是预测类问题（Predict），很显然顾名思义是通过直至当前时刻的观测变量，去预测下一时间点的状态变量 $z_{t+1}$ 和观测变量
$x_{t+1}$，即估计的是下面两类后验概率值：$p(z_{t+1}|x_1,x_2,x_3,...,x_t)$ 和
$p(x_{t+1}|x_1,x_2,x_3,...,x_t)$。

至此，我们从整体上对有向图模型中的三种动态图模型实例进行了综述，介绍了它们共有的性质特点和各自不同的特征，当然这一讲当中的很多内容，由于没有能够细致地展开，大家可能会感到迷糊，没有关系，随着后面几讲内容的逐步深入，我们会逐一介绍这三类模型。

