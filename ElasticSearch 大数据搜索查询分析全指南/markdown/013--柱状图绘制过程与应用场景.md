### 柱状图创建

柱状图一般是是用来反映数据的分布情况，查看数据的数量以及增长情况。比如说，一个同学的成绩表，不同科目为 X 轴，Y
轴是其对应的分数，制作一个柱状图能明显看到这个学生不同科目的情况，是否偏科？

因此当 X
轴并不是一个连续值是离散的，这个时候你就可以选择柱状图来反映离散的数据情况。就商务订单这个数据来说，我想查看哪个用户是我的忠实用户，过去一段时间内购买次数最多，这个时候就可以用柱状图来反映。

与上面可视化图一直，但是这里选择垂直条形图

![image-20191204214326095](https://images.gitbook.cn/2020-04-07-63001.png)

同样选择电子商务索引

![image-20191204214830771](https://images.gitbook.cn/2020-04-07-063001.png)

### 分析步骤

这里一共需要 6 个步骤

  1. 选择 Y 轴为计数
  2. 添加 X 轴
  3. 选择词聚合，因为要根据用户名称聚合，所以这里要选择词聚合
  4. 字段选择 _user_
  5. 柱状图排序方式这里选择计数排序，你可以选择按照字母排序或者自定义排序方式
  6. 这里显示大小，最好设置大一点，这样看的更全面一点

![image-20191204215040573](https://images.gitbook.cn/2020-04-07-063002.png)

我就很好奇，这些人买什么一周能买这么多东西，最夸张的是 elyssa 这个用户一周下单了 80 多次，这些人买的什么类型的东西呢？

### 柱状图分桶

**给定需求：** 查看不同用户购买不同类别的数量情况

想要查看用户下单次数，有想看他们买的什么类别的东西，因此只需要在上面柱状图的基础上，根据下单类别进行聚合。

  1. 添加 X 轴，拆分序列
  2. 子聚合选择词
  3. 字段选择 category.keyword（为什么需要加上 keyword，这将会在后面章节查询章节的时候专门介绍，目前选择这个就行）
  4. 大小设大一点就行

从图可以看出 elyssa
购买女士衣服最多，基本上都没买男士衣服，而且请大家注意购买男士衣服的柱状图，会有几个男性用户，虽然大部分都是购买男士衣服但是也购买了女士商品，相反女性用户柱状图反映的是都是购买女士商品没有男士商品。马云曾经说过，“女人的钱最好赚，因为除了给自己买东西以外会给孩子，老公买，男人只给自己买”，这张图能够打马云的脸了。

![image-20191204220303283](https://images.gitbook.cn/2020-04-07-063003.png)

### 柱状图分析进阶

**给定需求：** 使用柱状图分析不同地区不同商品类别销售情况

### 小结

柱状图的应用非常广泛，在 ES 中最需要理解的还是分组的概念，如何拆分序列，选择哪个字段等。

