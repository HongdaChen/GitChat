> æœ¬ç¯‡æ˜¯ç¬¬å…«éƒ¨åˆ†â€œç”Ÿæ€ç¯‡â€çš„ç¬¬ä¸€ç¯‡ã€‚åœ¨è¿™ä¸ªéƒ¨åˆ†ï¼Œæˆ‘ä¼šä¸ºä½ ä»‹ç» Docker ç”Ÿæ€ä¸­çš„ç›¸å…³é¡¹ç›®ï¼Œä»¥åŠå¦‚ä½•å‚ä¸åˆ° Docker é¡¹ç›®ä¸­ï¼Œæœ€åä¼šèŠèŠ
> Docker æœªæ¥çš„èµ°å‘ï¼Œæœ¬ç¯‡ï¼Œæˆ‘ä¸ºä½ ä»‹ç»ä¸‹ Docker ä¸ Kubernetes ç›¸å…³çš„å†…å®¹ã€‚

æ•´ä¸ªä¸“æ æˆ‘ä»¬åŸºæœ¬éƒ½åœ¨èŠ Docker çš„æ ¸å¿ƒåŸç†åŠå…¶åº”ç”¨ï¼Œæœ¬ç¯‡ï¼Œæˆ‘ä»¬è¿›å…¥â€œç”Ÿæ€ç¯‡â€çš„å­¦ä¹ ï¼Œä¸€èµ·æ¥çœ‹çœ‹åœ¨ Docker ç”Ÿæ€ä¸­ï¼Œè¿˜æœ‰å“ªäº›å€¼å¾—å…³æ³¨çš„æŠ€æœ¯ã€‚

### ä½¿ç”¨ Docker çš„ä¼˜åŠ¿å’Œç—›ç‚¹

åœ¨èŠå…¶ä»–æŠ€æœ¯ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥èŠèŠä½¿ç”¨ Docker å¸¦æ¥äº†å“ªäº›ä¼˜åŠ¿ä»¥åŠæœ‰å“ªäº›ç—›ç‚¹ï¼Œä»¥ä¾¿äºå¯¹å®ƒä»¥åŠå…¶ä»–æŠ€æœ¯æœ‰æ›´å¥½çš„è®¤è¯†ã€‚

#### **ä¼˜åŠ¿**

Docker ä¸ºæˆ‘ä»¬æä¾›äº†æ¯”è¾ƒå¥½çš„éš”ç¦»æ€§ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡å°†è¿è¡Œæ—¶çš„ä¾èµ–ä¸€åŒæ‰“å…¥é•œåƒè¿›è¡Œäº¤ä»˜ã€‚

åœ¨æ„å»ºé•œåƒæ—¶ï¼Œä½ å¯ä»¥å°†æ•´ä¸ªåº”ç”¨çš„ç¼–è¯‘ï¼Œæ‰“åŒ…ç¯å¢ƒå…¨éƒ¨å°è£…åœ¨ Dockerfile
ä¸­ï¼Œå†åˆ©ç”¨å¤šé˜¶æ®µæ„å»ºçš„ç‰¹æ€§ç¼©å°é•œåƒä½“ç§¯ã€‚äº¤ä»˜çš„æ—¶å€™ç”šè‡³å¯ä»¥ä»äº¤ä»˜é•œåƒè½¬å˜ä¸ºäº¤ä»˜ Dockerfileã€‚

åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ï¼Œç”±äºå®¹å™¨ä¸­å·²ç»åŒ…å«äº†åº”ç”¨æ‰€éœ€çš„åŸºæœ¬ä¾èµ–ï¼Œä¹Ÿå¯ä»¥æ’é™¤æ‰ç»å¤§å¤šæ•°ç³»ç»Ÿç¯å¢ƒå·®å¼‚é€ æˆçš„å½±å“ã€‚è¿™å°±ä¸ºæˆ‘ä»¬å¸¦æ¥äº†å¾ˆå¥½çš„å¯ **ç§»æ¤æ€§**
ã€‚ä»æ ¹æœ¬ä¸Šæœç»äº†ç±»ä¼¼äºâ€œåœ¨æˆ‘ç”µè„‘ä¸Šè¿è¡Œæ˜¯æ­£å¸¸çš„â€è¿™ç§é—®é¢˜ã€‚

å¯¹äº Docker é•œåƒè€Œè¨€ï¼Œå¯ä»¥ä¸ºå…¶æŒ‡å®šå¯¹åº”çš„ repo:tagï¼Œå¯ä»¥å°†è¿™äº›ä¿¡æ¯ä¸ä»£ç çš„ç‰ˆæœ¬æ§åˆ¶ç›¸ç»“åˆã€‚è¿™å°±å¸¦æ¥äº†è‰¯å¥½çš„ **ç‰ˆæœ¬æ§åˆ¶** èƒ½åŠ›ã€‚

æ­¤å¤–ï¼Œæ­£å¦‚æˆ‘åœ¨å‰é¢å†…å®¹ä¸­èŠ±äº†å¾ˆå¤§éƒ¨åˆ†ä»‹ç»çš„ï¼Œé€šè¿‡ä½¿ç”¨ Docker å¯ä»¥ä¸ºæˆ‘ä»¬æä¾›éå¸¸å¤šæ ·æ€§çš„å®‰å…¨ç­–ç•¥ï¼Œä¸ºæˆ‘ä»¬çš„åº”ç”¨ä¿é©¾æŠ¤èˆªã€‚è¿™ä¾¿æ˜¯è‰¯å¥½çš„ **å®‰å…¨æ€§**
ã€‚

å¦ä¸€æ–¹é¢ï¼ŒDocker ä¸ºæˆ‘ä»¬æä¾›äº†å¯¹å®¹å™¨è¿›è¡Œèµ„æºç®¡ç†ç›¸å…³çš„åŠŸèƒ½ã€‚å¯ä»¥è¾ƒå¥½çš„æ§åˆ¶èµ„æºä½¿ç”¨ï¼Œä»¥åŠè¿›è¡Œèµ„æºéš”ç¦»ã€‚

#### **ç—›ç‚¹**

å‡ åä¸ªå®¹å™¨ï¼Œå¯èƒ½ä½ è¿˜ç®¡çš„è¿‡æ¥ï¼Œä½†å¦‚æœé¢ä¸´æˆç™¾ä¸Šåƒçš„å®¹å™¨ï¼ŒåŒæ—¶éƒ¨ç½²åœ¨å¤šå°æœºå™¨ä¸Šæ—¶ï¼Œæ˜¯å¦è¿˜é‚£ä¹ˆå¥½ç®¡ç†å‘¢ï¼Ÿ

è¿™å°±æ˜¯æˆ‘ä»¬åœ¨å¤§è§„æ¨¡ä½¿ç”¨ Docker æ—¶ï¼Œæœ€å¤§çš„ç—›ç‚¹äº†ã€‚

å¤§è§„æ¨¡åœºæ™¯ä¸‹ï¼Œå®Œå…¨é€šè¿‡æ‰‹å·¥å®Œæˆè¿™äº›äº‹æƒ…å¤ªç¹æ‚äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€äº›å·¥å…·æˆ–è€…å¹³å°æ¥åšè¿™ä¸ªäº‹æƒ…ã€‚

ä½ å¯èƒ½ä¼šæƒ³åˆ°æ¯”å¦‚ Ansible ä¹‹ç±»çš„è¿ç»´å·¥å…·ï¼Œä½ è¦æ˜¯æ²¡æœ‰è¿‡äºå¤æ‚çš„éœ€æ±‚ï¼Œæˆ–è€…é  Docker è‡ªèº«çš„åŠŸèƒ½éƒ½å®Œå…¨èƒ½æ»¡è¶³ä¸šåŠ¡çš„è¯ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§å¯è¡Œçš„åŠæ³•ã€‚

æƒ³è±¡ä¸€ä¸‹ï¼Œåœ¨éƒ¨ç½²ä¸šåŠ¡å®¹å™¨çš„æ—¶å€™ï¼Œä¸ºäº†é¿å…å•ç‚¹æ•…éšœï¼Œé€šå¸¸æˆ‘ä»¬ä¼šé€‰æ‹©å°½é‡å°†å…¶åˆ†æ•£éƒ¨ç½²ã€‚æ­¤æ—¶ï¼Œå°±éœ€è¦è€ƒè™‘æœåŠ¡å™¨èµ„æºå®¹é‡ä»¥åŠæ•…éšœè‡ªæ„ˆç›¸å…³çš„é—®é¢˜äº†ã€‚

é€šè¿‡äººå·¥å’Œè‡ªåŠ¨åŒ–è„šæœ¬ä¹Ÿèƒ½å®Œæˆï¼Œä½†ç•¥éº»çƒ¦äº†ç‚¹ã€‚ è¿™ä¸ªæ—¶å€™å‡ºç°äº†å¾ˆå¤šçš„è§£å†³æ–¹æ¡ˆã€‚

### Kubernetes çš„è¯ç”Ÿ

2014 å¹´ Google åŸºäºå…¶å¤§è§„æ¨¡ç”Ÿäº§å®è·µç»éªŒå¼€æºå‡ºæ¥çš„
Kubernetesï¼ˆK8Sï¼‰ï¼Œé›†å®¹å™¨ç¼–æ’ã€æœåŠ¡å‘ç°ã€æ•…éšœè‡ªæ„ˆã€èµ„æºç®¡ç†è°ƒåº¦ç­‰åŠŸèƒ½äºä¸€èº«ï¼Œåœ¨å¼€æºåï¼Œè¿…é€Ÿå¾—åˆ°äº†ä¼—å¤šå…¬å¸çš„é’çã€‚

åŒæ—¶ï¼Œä¹Ÿå­˜åœ¨ç€å…¶ä»–æ¯”è¾ƒæ´»è·ƒçš„è§£å†³æ–¹æ¡ˆï¼Œå¦‚ Mesos å’Œ Docker Swarm ç­‰ï¼Œä¸€åº¦å½¢æˆäº†ä¸‰è¶³é¼ç«‹çš„å±€é¢ã€‚

éšç€å„å…¬å¸çš„é‡‡çº³åº¦ä»¥åŠå‚å•†çš„æ”¯æŒï¼ŒKubernetes å·²ç»æˆä¸ºå®¹å™¨ç¼–æ’é¢†åŸŸçš„äº‹å®æ ‡å‡†ã€‚æ‰€ä»¥å½“å‰ä¸»æµçš„æ¨èæ˜¯ Kubernetesã€‚

å¾ˆå¤šäººè§‰å¾— Kubernetes æ˜¯ä¸€ä¸ª PaaSï¼ˆPlatform as a Serviceï¼‰ç³»ç»Ÿï¼Œä½† Kubernetes å¹¶ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ PasS
ç³»ç»Ÿã€‚å®ƒå®é™…å·¥ä½œåœ¨å®¹å™¨å±‚ï¼Œæä¾›äº†ä¸€äº›ä¸ PasS ç±»ä¼¼æˆ–è€…å…±åŒçš„åŠŸèƒ½ï¼Œæ¯”å¦‚éƒ¨ç½²ã€æ‰©å®¹ã€ç›‘æ§ã€è´Ÿè½½å‡è¡¡ã€æ—¥å¿—è®°å½•ç­‰ã€‚

ç„¶è€Œå®ƒå¹¶ä¸æ˜¯ä¸ªå®Œå…¨ä¸€ä½“åŒ–çš„å¹³å°ï¼Œè¿™äº›åŠŸèƒ½åŸºæœ¬éƒ½æ˜¯å¯é€‰å¯é…ç½®çš„ã€‚

### Docker ä¸ Kubernetes ä¹‹é—´çš„è”ç³»

Kubernetes ä¸­æœ€åŸºæœ¬çš„éƒ¨ç½²å•å…ƒå«åš Podï¼Œæ¯ä¸ª Pod ä¸­å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨ã€‚

è€Œå¯åŠ¨å®¹å™¨åˆ™å¿…é¡»æœ‰ä¸€ä¸ªè¿è¡Œæ—¶æ¥å®Œæˆã€‚Docker æœ€ä¸»è¦çš„ä½œç”¨ä¾¿æ˜¯è¿™ä¸ªäº†ã€‚

èµ·åˆï¼ŒDocker ä½œä¸ºå®¹å™¨ç”Ÿæ€çš„é¢†å¤´ç¾Šï¼Œæ˜¯ Kubernetes çš„é»˜è®¤è¿è¡Œæ—¶ã€‚åæ¥ï¼ŒCoreOS å…¬å¸å‘å¸ƒäº†ä¸€ä¸ªåä¸º rkt
çš„é¡¹ç›®ï¼ŒKubernetes ä¸ºäº†èƒ½ç»™ç”¨æˆ·æä¾›æ›´å¤šçš„é€‰æ‹©ï¼Œä¹Ÿå°† rkt ä½œä¸ºäº†ä¸€ä¸ªå¯é€‰çš„å®¹å™¨è¿è¡Œæ—¶ã€‚

å†ä¹‹åï¼Œç”±äºå‡ºç°äº†æ›´å¤šçš„å®¹å™¨è¿è¡Œæ—¶ï¼Œæ¯”å¦‚ä» Docker ä¸­æ‹†åˆ†å‡ºæ¥çš„ containerd ç­‰ï¼ŒKubernetes
å‘ç°ä¸ºæ¯ä¸ªå®¹å™¨è¿è¡Œæ—¶æä¾›æ”¯æŒï¼Œä¼šå¸¦æ¥å¾ˆå¤šçš„éº»çƒ¦ã€‚è€Œä¸”éœ€è¦æ”¹åŠ¨ä¸å°‘ä»£ç ã€‚æ‰€ä»¥ Kubernetes æå‡ºäº†ä¸€ä¸ªæ¦‚å¿µï¼Œç§°ä¹‹ä¸º CRIï¼ˆContainer
Runtime Interfaceâ€”â€”å®¹å™¨è¿è¡Œæ—¶æ¥å£ï¼‰ã€‚

å‡¡æ˜¯ç¬¦åˆ CRI è§„èŒƒçš„å®¹å™¨è¿è¡Œæ—¶ï¼Œå‡å¯ä½œä¸ºå®¹å™¨è¿è¡Œæ—¶ä½¿ç”¨ã€‚

åˆ°ç°åœ¨ä¸ºæ­¢ï¼ŒDocker ä»ç„¶æ˜¯ Kubernetes ä¸­ä½¿ç”¨æœ€å¤šçš„å®¹å™¨è¿è¡Œæ—¶ã€‚ åŒæ—¶ï¼ŒDocker ä¹Ÿæ˜¯ä½¿ç”¨æœ€å¤šçš„å®¹å™¨å¹³å°ï¼ˆæˆ–å·¥å…·ï¼‰ã€‚

### Docker x Kubernetes

ä»‹ç»äº†è¿™ä¹ˆå¤šï¼Œé‚£å¦‚ä½•èƒ½å¿«é€Ÿçš„ä½¿ç”¨ Kubernetes å‘¢ï¼Ÿ

Docker Desktop for Windows/Mac å‡å†…ç½®äº† Kubernetesï¼Œå¦‚æœä½ å·²ç»å®‰è£…äº†æœ€æ–°ç‰ˆæœ¬çš„ Docker
Desktopï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ä¸­å¯åŠ¨å…¶å†…ç½®çš„ Kubernetesã€‚

é™¤äº†è¿™ç§æ–¹å¼å¤–ï¼Œæˆ‘è¦ç‰¹åˆ«æ¨èå¦ä¸€ç§æ–¹å¼ï¼š[KINDï¼ˆKubernetes IN
Dockerï¼‰](https://github.com/kubernetes-sigs/kind)ï¼Œå°† Kubernetes è¿è¡Œåœ¨ Docker ä¸­ã€‚

ä½¿ç”¨è¿™ç§æ–¹å¼çš„å¥½å¤„åœ¨äºï¼Œä½ å¯ä»¥è½»æ¾çš„åœ¨å·²ç»å®‰è£…äº† Docker çš„æœºå™¨ä¸Šï¼Œå¾ˆæ–¹ä¾¿çš„å¯åŠ¨ä¸€ä¸ªå•èŠ‚ç‚¹æˆ–è€…å¤šèŠ‚ç‚¹çš„ Kubernetes
é›†ç¾¤ã€‚ï¼ˆæ³¨ï¼šå¤šèŠ‚ç‚¹éœ€è¦æ›´å¤šçš„ç³»ç»Ÿèµ„æºï¼‰

ç¤ºä¾‹å¦‚ä¸‹ã€‚

1\. å…ˆå®‰è£… kind çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼š

    
    
    (MoeLove) âœ  ~ wget -q -O kind https://github.com/kubernetes-sigs/kind/releases/download/v0.7.0/kind-linux-amd64 
    (MoeLove) âœ  ~ chmod +x kind
    (MoeLove) âœ  ~ ./kind version
    kind v0.7.0 go1.13.6 linux/amd64
    

2\. ä½¿ç”¨ kind å¯åŠ¨ä¸€ä¸ªå•èŠ‚ç‚¹çš„ Kubernetes é›†ç¾¤ï¼š

    
    
    (MoeLove) âœ  ~ ./kind create cluster --name moelove        
    Creating cluster "moelove" ...
     âœ“ Ensuring node image (kindest/node:v1.17.0) ğŸ–¼ 
     âœ“ Preparing nodes ğŸ“¦  
     âœ“ Writing configuration ğŸ“œ 
     âœ“ Starting control-plane ğŸ•¹ï¸ 
     âœ“ Installing CNI ğŸ”Œ 
     âœ“ Installing StorageClass ğŸ’¾ 
    Set kubectl context to "kind-moelove"
    You can now use your cluster with:
    
    kubectl cluster-info --context kind-moelove
    
    Not sure what to do next? ğŸ˜… Check out https://kind.sigs.k8s.io/docs/user/quick-start/
    

æ³¨ï¼šè¿™é‡Œéœ€è¦ä¸‹è½½ä¸€ä¸ª `kindest/node:v1.17.0` çš„é•œåƒï¼Œæ‰˜ç®¡åœ¨ DockerHub ä¸Šï¼Œé•œåƒä½“ç§¯æ˜¯
1.25GBã€‚ä¸‹è½½é€Ÿåº¦å–å†³äºä½ çš„ç½‘é€Ÿæƒ…å†µã€‚

3\. å®‰è£… kubectl

å®‰è£…å®Œæˆåï¼Œè¾“å‡ºå†…å®¹ä¸­æç¤ºä½ å¯ä»¥é€šè¿‡ kubectl å‘½ä»¤æ“ä½œé›†ç¾¤ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å®‰è£… kubectlã€‚è¿™æ˜¯ä¸€ä¸ª Kubernetes é›†ç¾¤çš„ CLI
å·¥å…·ã€‚å®ƒç›®å‰æ‰˜ç®¡åœ¨ Kubernetes çš„å®˜æ–¹å­˜å‚¨ä»“åº“ä¸­ï¼Œä½ å¯ä»¥åœ¨ GitHub çš„ Release é¡µé¢è¿›è¡Œä¸‹è½½ã€‚å½“ç„¶ï¼Œ **æˆ‘ä»¬å¯ä»¥æœ‰æ›´ç®€å•çš„åŠæ³•**
ã€‚

    
    
    (MoeLove) âœ  ~ docker ps -l
    CONTAINER ID        IMAGE                  COMMAND                  CREATED             STATUS              PORTS                       NAMES
    ee85ab2746a6        kindest/node:v1.17.0   "/usr/local/bin/entrâ€¦"   4 minutes ago       Up 4 minutes        127.0.0.1:49153->6443/tcp   moelove-control-plane
    (MoeLove) âœ  ~ docker cp moelove-control-plane:/kind/bin/kubectl . 
    (MoeLove) âœ  ~ ./kubectl get nodes 
    NAME                    STATUS   ROLES    AGE    VERSION
    moelove-control-plane   Ready    master   5m2s   v1.17.0
    

å¯ä»¥ç›´æ¥ä»å®¹å™¨ä¸­å°† kubectl äºŒè¿›åˆ¶æ–‡ä»¶æ‹·è´åˆ°æœ¬åœ°ã€‚

### æ€»ç»“

æœ¬ç¯‡ï¼Œæˆ‘ä¸ºä½ å¤§æ¦‚ä»‹ç»äº† Kubernetes è¯ç”Ÿçš„èƒŒæ™¯ï¼Œä»¥åŠä½¿ç”¨ Docker çš„ä¼˜åŠ¿åŠç—›ç‚¹ã€‚

åŒæ—¶ä»‹ç»äº†å¦‚ä½•åœ¨æœ¬åœ°ä½¿ç”¨ Docker åˆ›å»ºä¸€ä¸ªå•èŠ‚ç‚¹çš„ Kubernetes é›†ç¾¤ã€‚æ­¤é›†ç¾¤å¯ç”¨äºæœ¬åœ°å¿«é€Ÿçš„æµ‹è¯•å’Œä½“éªŒã€‚

ä¸‹ä¸€ç¯‡ï¼Œæˆ‘æ¥ä¸ºä½ ä»‹ç»å¦ä¸€ä¸ªå®¹å™¨è¿è¡Œæ—¶ï¼šcontainerdã€‚

